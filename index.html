<!DOCTYPE html>
<html>
<head>
<style>
body {
    font-family: Helvetica, Arial;
    font-size: 100%;
}
ul {
    color: black;
    font-size: 100%;
}
.drop {
    color: white;
    background-color: mediumseagreen;
    font-size: 200%;
    width: 600px;
    height: 240px;
    line-height: 240px;
    border-radius: 4px;
    text-align: center;
}
</style>
</head>
<body>
    <div id="drop" class="drop">Glissez le fichier à analyser ici...</div>
    <div>
    <ul id="list"></ul>
    </div>

    <script type="text/javascript">
    
    function escapeXml(unsafe) {
    return unsafe.replace(/[<>&'"]/g, function (c) {
        switch (c) {
            case '<': return '&lt;';
            case '>': return '&gt;';
            case '&': return '&amp;';
            case '\'': return '&apos;';
            case '"': return '&quot;';
        }
    });
}
    
    function handleFileSelect(evt) {
        console.log ("FileSelect");
        evt.stopPropagation();
        evt.preventDefault();

        var files = evt.dataTransfer.files; // FileList object.

        // files is a FileList of File objects. List some properties.
        var output = document.getElementById('list');
        for (var i = 0, f; f = files[i]; i++) {
          if (f.type != 'text/xml') {
            continue;
          }
          var _li = document.createElement("li");
          output.insertBefore(_li, null);
          
          (function (xml, li) {
          var reader = new FileReader ();
          reader.onload = function(e) {
            li.innerHTML = '<strong>'.concat (escape(xml.name), '</strong> (', xml.type || 'n/a', ') - ',
                        xml.size, ' bytes, last modified: ',
                        xml.lastModifiedDate ? xml.lastModifiedDate.toLocaleDateString() : 'n/a',
                        '<div>', escapeXml (e.target.result), '</div>');
          };
          reader.readAsText (xml);
          })(f, _li);
        }
    }

    function handleDragOver(evt) {
        evt.stopPropagation();
        evt.preventDefault();
        evt.dataTransfer.dropEffect = 'copy'; // Explicitly show this is a copy.
    }

    // Setup the dnd listeners.
    var dropZone = document.getElementById('drop');
    dropZone.addEventListener('dragover', handleDragOver, false);
    dropZone.addEventListener('drop', handleFileSelect, false);
    </script>
</body>
